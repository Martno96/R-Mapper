{"ast":null,"code":"import { createSlice } from '@reduxjs/toolkit';\nconst initialItems = localStorage.getItem('cast') ? JSON.parse(localStorage.getItem('cast')) : {\n  username: \"\",\n  coordinates: \"\",\n  description: \"\",\n  actions: [],\n  history: [],\n  loadProgress: 100,\n  error: null\n};\nconst game = createSlice({\n  name: \"cast\",\n  initialState: initialItems,\n  reducers: {\n    setUsername: (store, action) => {\n      localStorage.setItem('username', JSON.stringify(action.payload));\n      store.username = action.payload;\n    }\n  }\n});\nexport const advance = input => {\n  let isStart = input.type ? false : true;\n  let endpoint = \"\";\n  let postBody = {};\n  return (dispatch, getState) => {\n    const state = getState();\n\n    if (isStart) {\n      endpoint = \"start\";\n      postBody = JSON.stringify({\n        username: input\n      });\n    } else {\n      endpoint = \"action\";\n      postBody = JSON.stringify({\n        username: state.game.username,\n        type: input.type,\n        direction: input.direction\n      });\n      dispatch(game.actions.logAction(JSON.parse(postBody)));\n    }\n\n    dispatch(game.actions.setLoadProgress(33));\n    fetch(`https://wk16-backend.herokuapp.com/${endpoint}`, {\n      method: \"POST\",\n      headers: {\n        'Content-Type': 'application/json;charset=utf-8'\n      },\n      body: postBody\n    }).then(res => {\n      dispatch(game.actions.setLoadProgress(55));\n      return res.json();\n    }).then(update => {\n      dispatch(game.actions.setLoadProgress(77));\n      return dispatch(game.actions.setGameState(update));\n    }).catch(error => dispatch(game.actions.setError(error.message))).finally(() => dispatch(game.actions.setLoadProgress(100)));\n  };\n};\nexport default game;","map":{"version":3,"sources":["C:/Users/martn/Documents/New Documents 2019/Technigo codin/storymapper spreadsheet/my-app/src/reducers/cast.js"],"names":["createSlice","initialItems","localStorage","getItem","JSON","parse","username","coordinates","description","actions","history","loadProgress","error","game","name","initialState","reducers","setUsername","store","action","setItem","stringify","payload","advance","input","isStart","type","endpoint","postBody","dispatch","getState","state","direction","logAction","setLoadProgress","fetch","method","headers","body","then","res","json","update","setGameState","catch","setError","message","finally"],"mappings":"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","sourcesContent":["import { createSlice } from '@reduxjs/toolkit'\r\n\r\nconst initialItems = localStorage.getItem('cast')\r\n? JSON.parse(localStorage.getItem('cast'))\r\n: {\r\n  username: \"\",\r\n  coordinates: \"\",\r\n  description: \"\",\r\n  actions: [],\r\n  history: [],\r\n  loadProgress: 100,\r\n  error: null\r\n}\r\n\r\nconst game = createSlice ({\r\n  name: \"cast\",\r\n  initialState: initialItems,\r\n  reducers: {\r\n    setUsername: (store, action) => {\r\n      localStorage.setItem('username', JSON.stringify(action.payload))\r\n      store.username = action.payload\r\n    }\r\n  }\r\n})\r\n\r\nexport const advance = (input) => {\r\n  let isStart = input.type ? false : true\r\n  let endpoint = \"\"\r\n  let postBody = {}\r\n\r\n  return (dispatch, getState) => {\r\n    const state = getState()\r\n    if (isStart) {\r\n      endpoint = \"start\"\r\n      postBody = JSON.stringify({\r\n        username: input\r\n      })\r\n    } else {\r\n      endpoint = \"action\"\r\n      postBody = JSON.stringify({\r\n        username: state.game.username,\r\n        type: input.type,\r\n        direction: input.direction\r\n      })\r\n      dispatch(game.actions.logAction(JSON.parse(postBody)))\r\n    }\r\n    dispatch(game.actions.setLoadProgress(33))\r\n    fetch(`https://wk16-backend.herokuapp.com/${endpoint}`, {\r\n      method: \"POST\",\r\n      headers: {\r\n        'Content-Type': 'application/json;charset=utf-8'\r\n      },\r\n      body: postBody\r\n    })\r\n      .then(res => {\r\n        dispatch(game.actions.setLoadProgress(55))\r\n        return res.json()\r\n      })\r\n      .then(update => {\r\n        dispatch(game.actions.setLoadProgress(77))\r\n        return dispatch(game.actions.setGameState(update))\r\n      })\r\n      .catch(error => dispatch(game.actions.setError(error.message)))\r\n      .finally(() => dispatch(game.actions.setLoadProgress(100))) \r\n    }\r\n}\r\n\r\nexport default game"]},"metadata":{},"sourceType":"module"}